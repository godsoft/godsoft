<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Comtnadbk">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="ComtnadbkVO" type="kr.godsoft.egovframe.generatorwebapp.comtnadbk.service.ComtnadbkVO"/>
	
	<resultMap id="comtnadbk" class="kr.godsoft.egovframe.generatorwebapp.comtnadbk.service.ComtnadbkVO">
		<result property="emplyrId" column="emplyr_id" columnIndex="1"/>
		<result property="ncrdId" column="ncrd_id" columnIndex="2"/>
		<result property="frstRegistPnttm" column="frst_regist_pnttm" columnIndex="3"/>
		<result property="lastUpdtPnttm" column="last_updt_pnttm" columnIndex="4"/>
		<result property="frstRegisterId" column="frst_register_id" columnIndex="5"/>
		<result property="lastUpdusrId" column="last_updusr_id" columnIndex="6"/>
		<result property="adbkConstntId" column="adbk_constnt_id" columnIndex="7"/>
		<result property="nm" column="nm" columnIndex="8"/>
		<result property="emailAdres" column="email_adres" columnIndex="9"/>
		<result property="mbtlnum" column="mbtlnum" columnIndex="10"/>
		<result property="fxnum" column="fxnum" columnIndex="11"/>
		<result property="offmTelno" column="offm_telno" columnIndex="12"/>
		<result property="houseTelno" column="house_telno" columnIndex="13"/>
		<result property="adbkId" column="adbk_id" columnIndex="14"/>
	</resultMap>
	
	<insert id="comtnadbkDAO.insertComtnadbk_S">
		<![CDATA[
            INSERT INTO comtnadbk (
                emplyr_id
                , ncrd_id
                , frst_regist_pnttm
                , frst_register_id
                , adbk_constnt_id
                , nm
                , email_adres
                , mbtlnum
                , fxnum
                , offm_telno
                , house_telno
                , adbk_id
            ) VALUES (
                #emplyrId#
                , #ncrdId#
                , SYSDATE
                , #frstRegisterId#
                , #adbkConstntId#
                , #nm#
                , #emailAdres#
                , #mbtlnum#
                , #fxnum#
                , #offmTelno#
                , #houseTelno#
                , #adbkId#
            )
		]]>
	</insert>
	
	<update id="comtnadbkDAO.updateComtnadbk_S">
		<![CDATA[
            UPDATE comtnadbk
                SET
                emplyr_id = #emplyrId#
                , ncrd_id = #ncrdId#
                , last_updt_pnttm = SYSDATE
                , last_updusr_id = #lastUpdusrId#
                , adbk_constnt_id = #adbkConstntId#
                , nm = #nm#
                , email_adres = #emailAdres#
                , mbtlnum = #mbtlnum#
                , fxnum = #fxnum#
                , offm_telno = #offmTelno#
                , house_telno = #houseTelno#
                , adbk_id = #adbkId#
                WHERE 1 = 1
                AND adbk_constnt_id = #adbkConstntId#
                AND adbk_id = #adbkId#
		]]>
	</update>
	
	<delete id="comtnadbkDAO.deleteComtnadbk_S">
		<![CDATA[
			DELETE FROM comtnadbk
				WHERE 1 = 1
				AND adbk_constnt_id = #adbkConstntId#
				AND adbk_id = #adbkId#
		]]>
	</delete>
	
	<select id="comtnadbkDAO.selectComtnadbk_S" resultMap="comtnadbk">
		<![CDATA[
			SELECT
				emplyr_id
				, ncrd_id
				, frst_regist_pnttm
				, last_updt_pnttm
				, frst_register_id
				, last_updusr_id
				, adbk_constnt_id
				, nm
				, email_adres
				, mbtlnum
				, fxnum
				, offm_telno
				, house_telno
				, adbk_id
			FROM COMTNADBK
			WHERE adbk_constnt_id = #adbkConstntId#
				AND adbk_id = #adbkId#
		]]>
	</select>
	
	<select id="comtnadbkDAO.selectComtnadbkList_D" parameterClass="ComtnadbkVO" resultClass="egovMap">
	       SELECT 
								A.EMPLYR_ID
								, A.NCRD_ID
								, A.FRST_REGIST_PNTTM
								, A.LAST_UPDT_PNTTM
								, A.FRST_REGISTER_ID
								, A.LAST_UPDUSR_ID
								, A.ADBK_CONSTNT_ID
								, A.NM
								, A.EMAIL_ADRES
								, A.MBTLNUM
								, A.FXNUM
								, A.OFFM_TELNO
								, A.HOUSE_TELNO
								, A.ADBK_ID
			       FROM
            (
				SELECT
								EMPLYR_ID
								, NCRD_ID
								, FRST_REGIST_PNTTM
								, LAST_UPDT_PNTTM
								, FRST_REGISTER_ID
								, LAST_UPDUSR_ID
								, ADBK_CONSTNT_ID
								, NM
								, EMAIL_ADRES
								, MBTLNUM
								, FXNUM
								, OFFM_TELNO
								, HOUSE_TELNO
								, ADBK_ID
							, ROWNUM
				FROM COMTNADBK
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					EMPLYR_ID = #searchKeyword#
				</isEqual>
					<isEqual prepend="AND" property="searchCondition" compareValue="1">
					NCRD_ID LIKE '%' || #searchKeyword# || '%'
				</isEqual>
						ORDER BY 
							ADBK_CONSTNT_ID DESC
							, ADBK_ID DESC
					) A
			WHERE ROWNUM BETWEEN #firstIndex# AND #recordCountPerPage#
	</select>

	<select id="comtnadbkDAO.selectComtnadbkListTotCnt_S" parameterClass="ComtnadbkVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM COMTNADBK
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				EMPLYR_ID = #searchKeyword#
			</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
				NCRD_ID LIKE '%' || #searchKeyword# || '%'
			</isEqual>
		</select>

</sqlMap>
